
<!DOCTYPE html>
<html class="no-js">


  <title>Songs</title>

  <head>

 <style type="text/css">
div#mp3_player{ width:638px; height:0px; background:#000000; margin-top: 0px; vertical-align: middle; margin-top: -30px; }
div#mp3_player > div > audio{  width:638px; background:#ffffff; vertical-align: middle; margin-left: 0px; margin-top: -355px;}

div#mp3_player > canvas{width:720px; height:385px; position: relative; background:#ffffff; opacity: 0.1; position: relative; margin-top: -355px; left: 0px;}
</style>




</head>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-568810505c304f97"></script>

<div class="container">

<!--div class="navfix centered">

<%# render '/layouts/nav3' %> 
</div-->


 <div class="centered ">





<% if notice.present? %>

 <span class="alert alert-success fade in">
  <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                  <%= notice %>.
  </span>

  <% end %>
    

    <div class="centered fieldfix">
        <%= render '/components/preach_form' %><br><br>
        </div>

<div class="pullsidenav"></div>
        <p></p>
        <p></p>
        <p></p>

  
    <div class="col-sm-8"><!--left col starts-->



  





    <div class="paneloveride " data-fill-color="true"><!--paneloveride starts-->
    <!--div class="btn btn-default mb-1x mr-1x top-corner-no-margin-left zindez999"> <i class="fa fa-tags "></i>&nbsp<%#raw tag_links(@song.all_tags) %>

    </div-->

    

    








 




    <% if @song.soundcover? %>
        <%=link_to (image_tag @song.soundcover.url(:thumb), :class => "img-responsive centered hov"), @song %>
        <% else %> 
        <%= image_tag("fallback/noimage.jpg", :class => "img-responsive centered hov") %>

        


       <% end %> 
       

           <div class="img-responsive">

           <div id="mp3_player">
           <div id="audio_box"></div>           
           <canvas id="analyser_render"></canvas>         
           </div>
           












          <% if @song.preacher.profilephoto? %>

          <%#link_to (image_tag @song.user.profilephoto.url(:large), :class => "kit-avatar kit-avatar-96 border-white pull-left"), users_path(@user) %>
        <%= link_to (image_tag(@song.preacher.profilephoto.url(:large), :class => "kit-avatar kit-avatar-96 border-white pull-left pullup padding10")), preacher_path(@song.preacher_id) %>
        <% else %> 
        <%= link_to (image_tag("fallback/unknown-profile.jpg", :class => "kit-avatar kit-avatar-96 border-white pull-left pullup padding10")), preacher_path(@song.preacher_id) %>


       <% end %> 





        

                  

       <div class="margin-left10 pullup-small"><h3> <%= link_to (@song.title), @song %>
       <i class="fa fa-microphone "></i><%= " " %><%= " " %><%= @song.artist %> 
       
      </h3>

      </div></div>






<div class="hide">
     <ul id="playlist">

<li song="<%= @song.sound.url if @song.sound %>" cover="<%= @song.soundcover.url if @song.soundcover %> "   artist="<%= @song.artist %>" title="<%= truncate(@song.title, length: 14) %>">      

    </li>

    </ul>

    </div>






<p></p>
 <div id= "top-pages" class="tab-pane pullupleft">

 <div class="pull-right bigheart">

    <div id="song_<%= @song.id %>_likes"><%= render partial: "likes", locals: {song: @song} %>
  

</div>
          
      </div>



       <small>

       <strong><i class="fa fa-upload "></i><%= " " %><%= @song.preacher.firstname.split(" ").map(&:capitalize).join(" ") if @song.preacher.firstname %><%= " " %><%= @song.preacher.lastname.split(" ").map(&:capitalize).join(" ") if @song.preacher.lastname %></strong>

       </small> 

       <div class="dropdown">

        <button class="btn btn-xs btn-default btn-icon dropdown-toggle " data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><i class="fa fa-ellipsis-v rediconcolor"></i></button>
                          <ul class="dropdown-menu dropdown-menu-right pullup-small">
                           

                            <li>
                            
                            
      <% if @song.preacher == current_preacher -%>
  
    <%= link_to 'Edit this audio', edit_song_path(@song), class: "btn btn-clean padding10" %>
    </li>
   
    <% end %> 

     <li>
     <% if @song.preacher == current_preacher -%>

     


    <%= link_to 'Delete this audio', @song, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-clean padding10" %>

  <% end %>   

                           
                              </li>


                            <li><a href="#">report copyright infringement</a></li>
                             


                            <li><a href="#">Report spam or abuse</a></li>
                            
                          </ul>
  </div>


  &nbsp &nbsp 

  <small>

       <strong><i class="fa fa-eye ">&nbsp </i><%= @song.impressionist_count(:filter=>:session_hash) %></strong>

       </small> 
  </div>

                








     
 </div> 

      
     

      




<%# @song.impressionist_count %>







     <%# link_to 'Back', songs_path %> <!--button type="button" class="btn btn-bordered btn-primary"><i class="icon-plus fa-fw"></i> Add</button-->

  






<!--div><strong>Comments:<%# @song.reviews.count %></strong></div>
                <div><%# @song.rating %></div-->




                <!--Coments-->



  

<!-- collapse starts-->
<div id="song_<%= @song.id %>_likes">

     <%# render partial: "likes", locals: {song: @song} %>
  

</div>


  <div class="panel-group pullupleft" id="accordion1">
                <div class="panel">
                  <div class="panel-heading">
                    <h3 class="panel-title">

                      <a data-toggle="collapse" data-parent="#accordion1" href="#collapseOne">
                        <i class="fa fa-share-alt "></i> Share
                      </a>



                    </h3><!-- /panel-title -->
                  </div><!-- /panel-heading -->
                  <div id="collapseOne" class="panel-collapse collapse">
                    <div class="panel-body">
                     

                      <!-- Go to www.addthis.com/dashboard to customize your tools -->
                      <div class="addthis_sharing_toolbox"></div>

                      
                    </div><!-- /panel-body -->
                  </div><!-- /panel-collapse -->
                </div><!-- /panel -->

                <div class="panel">
                  <div class="panel-heading">
                    <h3 class="panel-title">


                    

<a data-toggle="collapse" data-parent="#accordion1" href="#collapseTwo">
                        More
                      </a>
                
                
                    </h3><!-- /panel-title-->
                  </div><!-- /panel-heading-->
                  <div id="collapseTwo" class="panel-collapse collapse">
                    <div class="panel-body">
                      <div><%= @song.desc %></div>
                    </div><!-- /panel-body-->
                  </div><!-- /panel-collapse-->
                </div><!-- /panel-->

                
              </div><!-- /panel-group -->
<!-- End of collapse-->


  
              <div class="paneloveride pullup5" data-fill-color="true">
        <div><%= render 'songcomments' %>


        <%# render 'disq' %>



        </div>
               </div>




<div class="tags-cloud glassy-bg">
  <h4>Tags Cloud</h4>
  
</div>



</div><!--right col ends-->





  <!--rleftcol starts-->


  <div class="col-sm-4">



 
              <div class="panel" data-context="cyan">
                <div class="panel-heading">
                  <div class="panel-control pull-right">
                    <ul class="nav nav-tabs nav-contrast-dark">
                      
                      <li class="active"><a href="#tab1" data-toggle="tab">

                      Related

                      </a>
                      </li>

                      <li><a href="#tab2" data-toggle="tab">Lyrics/Text</a></li>

                      <li><a href="#tab3" data-toggle="tab">Video</a></li>
                      


                    </ul>
                    
                  </div>
                  <h3 class="panel-title">With Tabs</h3>
                </div><!-- /.panel-heading -->
                <div class="panel-body">
                  <div class="tab-content">
                    <div class="tab-pane fade in active" id="tab1">
                      
                 <strong>


                      <%#raw tag_links(@song.all_tags) %>


  



                      </strong>


                    </div>
                    <div class="tab-pane fade" id="tab2">

                    <!--lyrics-->     <!-- /.cols -->
                      


                    </div>
                    
                    <div class="tab-pane fade embed-container" id="tab3">
                      <strong>Video</strong>
                     
                    </div>
                    
                  </div>
                </div><!-- /.panel-body -->
              </div><!-- /.panel -->
            


            <div class="clearfix"></div>







  

  
  
  </div><!--leftcol ends-->

</div><!--end of row-->

</div>




<br /><br /><br /><br /><br /><br />





<footer class="footer-wrapper" role="contentinfo"> 

      <div class="footer">


       



        <div id="audio-player">
    <div id="audio-info">      
      
      <span class="artist"></span> - <span class="title"></span>
    </div>

<div id = "playercontainer centered">

<div class ="coverup">

   

        <div id="tracker">

      <div id="progressBar">
        <div id="progress"></div>
      </div>
     
     


<div id="buttons">
     <span>
      <button id="prev"></button>
      <button id="play"></button>
      <button id="pause"></button>
      <!--button id="stop"></button-->
      <button id="next"></button>
      <button id="speaker"></button>
      <button id="mute"></button>
      <button id="unloop"></button>
      <button id="loop"></button>
      </span>
<span id="duration"> </span>




       





        





</div> <!--playercontainer-->

        <div class="pull-right">
<div class="volume" style="position: relative; bottom: 0px; background-color: rgb(0, 0, 0); cursor: pointer; border-radius: 5px; height: 10px; border: 1px solid rgb(0, 0, 0); box-shadow: 0px 0px 5px rgb(255, 255, 255); width: 10px;"><div class="volume-wrapper" style="border: 1px solid rgb(255, 255, 255); border-radius: 4px; height: 8px; width: 8px; position: absolute; bottom: 0px;"><div class="level" style="background:#fff; height: 100%; width: 8px;"></div></div></div>

           <div id="audio-image">
           <img class="cover" />          
          </div>

           </div>




             <!-- analyzer -->
         
     



     </div>
        </div>
        <div>Wrapkit Template  &copy; 2015
        </div>
      </div>


    <!-- /.buttons -->
    </footer><!-- /.FOOTER -->

    </body>
</html>



    <!--script for player-->

    <script>

var audio;

// Establish all variables that your Analyser will use
var canvas, ctx, source, context, analyser, fbc_array, bars, bar_x, grd, hue, bar_width, bar_height, numBars;


//Hide Pause Initially
$('#pause').hide();
$('#mute').hide();
$('#unloop').hide();
$('#playin').hide();

  
//Initializer - Play First Song
initAudio($('#playlist li:first-child'));
//initAudio($('#hov li:first-child'));
  
function initAudio(element){
  var song = element.attr('song');
    var title = element.attr('title');
    var cover = element.attr('cover');
    var artist = element.attr('artist');


  
    
    

    // Progress Bar Container
  //progressBar = document.getElementById('progressBar');
 // progress = document.getElementById('progress');



  // Buttons Container
 

  
  //Create a New Audio Object
  audio = new Audio(song);
  audio.loop = true;
  if(!audio.currentTime){
    $('#duration').html('0.00');
  }

  $('#audio-player .title').text(title);
    $('#audio-player .artist').text(artist);
  
  //Insert Cover Image
  $('img.cover').attr('src','' + cover);
  
  $('#playlist li').removeClass('active');
  //$('#hov li').removeClass('active');
  
    element.addClass('active');


 


}

   

//Play Button



$('#play').click(function(){



  audio.play();

    $('#play').hide();
   



  
  $('#pause').show();
  $('#duration').fadeIn(400);
  showDuration();
});




//Pause Button
$('#pause').click(function(){
  audio.pause();
  $('#pause').hide();
  $('#play').show();


    // Visualize snippet
  context = new AudioContext(); // AudioContext object instance
  analyser = context.createAnalyser(); // AnalyserNode method
  canvas = document.getElementById('analyser_render');
  ctx = canvas.getContext('2d');
  // Re-route audio playback into the processing graph of the AudioContext
  source = context.createMediaElementSource(audio); 
  source.connect(analyser);
  analyser.connect(context.destination);
  frameLooper();
  // Visualize snippet ends


});
  


  //volume


  
  //end
//Stop Button
//$('#stop').click(function(){
  //audio.pause();    
  //audio.currentTime = 0;
  //$('#pause').hide();
  //$('#play').show();
  
  //showDuration();
//});

//Play speaker
$('#speaker').click(function(){
  audio.muted = true;
  $('#speaker').hide();
  $('#mute').show();
  $('#duration').fadeIn(400);
  showDuration();
});

//Pause BMute
$('#mute').click(function(){
  
  audio.muted= false;
  $('#speaker').show();
  $('#mute').hide();
});

//Next Button
$('#next').click('ended',function(){
    audio.pause();

  $('#loop').show();
  $('#unloop').hide();
  $('#pause').show();
  $('#play').show();

    var next = $('#playlist li.active').next();
    if (next.length == 0) {
        next = $('#playlist li:first-child');
    }
    initAudio(next);
  audio.play();
  showDuration();

  // Visualize snippet
  context = new AudioContext(); // AudioContext object instance
  analyser = context.createAnalyser(); // AnalyserNode method
  canvas = document.getElementById('analyser_render');
  ctx = canvas.getContext('2d');
  // Re-route audio playback into the processing graph of the AudioContext
  source = context.createMediaElementSource(audio); 
  source.connect(analyser);
  analyser.connect(context.destination);
  frameLooper();
  // Visualize snippet ends
});

//Play unloop
$('#loop').click(function(){
  audio.loop = false;
  audio.load();
  
  $('#play').show();
  $('#loop').hide();
  $('#unloop').show();
  $('#pause').hide();
  $('#duration').fadeIn(400);
  showDuration();
});
//loop
$('#unloop').click(function(){
  audio.loop = true;
  audio.load();
  $('#loop').show();
  $('#unloop').hide();
  $('#play').show();
   $('#pause').hid();
  
});





//Prev Button
$('#prev').click(function(){
    audio.pause();
   
  $('#loop').show();
  $('#unloop').hide();
   
    var prev = $('#playlist li.active').prev();
    if (prev.length == 0) {
        prev = $('#playlist li:last-child');
    }
    initAudio(prev);
  audio.play();
  showDuration();

  // Visualize snippet
  context = new AudioContext(); // AudioContext object instance
  analyser = context.createAnalyser(); // AnalyserNode method
  canvas = document.getElementById('analyser_render');
  ctx = canvas.getContext('2d');
  // Re-route audio playback into the processing graph of the AudioContext
  source = context.createMediaElementSource(audio); 
  source.connect(analyser);
  analyser.connect(context.destination);
  frameLooper();
  // Visualize snippet ends

});

//Playlist Song Click
$('#playlist li').click(function () {
    audio.pause();


  $('#loop').show();
  $('#unloop').hide();
   
    initAudio($(this));
  $('#play').hide();
  $('#pause').show();
  $('#duration').fadeIn(400);
  audio.play();
  showDuration();
});

//CoverPlay Song Click



//Volume Control
$('#volume').change(function(){

  audio.volume = parseFloat(this.value / 100);
});


 
  

//Time Duration
function showDuration(){
  $(audio).bind('timeupdate', function(){
    //Get hours and minutes
    var s = parseInt(audio.currentTime % 60);
    var m = parseInt((audio.currentTime / 60) % 60);
    //Add 0 if seconds less than 10
    if (s < 10) {
      s = '0' + s;
    }
    $('#duration').html(m + '.' + s); 
    var value = 0;
    if (audio.currentTime > 0) {
      value = Math.floor((100 / audio.duration) * audio.currentTime);
    }
    $('#progress').css('width',value+'%');
  });


}



</script> 


<script>
// Create a new instance of an audio object and adjust some of its properties


var SMOOTHING = 0.8;
var FFT_SIZE = 2048;

//

    //

window.addEventListener("load", initMp3Player, true);
function initMp3Player(){
  document.getElementById('audio_box').appendChild(audio);
  context = new AudioContext(); // AudioContext object instance
  analyser = context.createAnalyser(); // AnalyserNode method
  canvas = document.getElementById('analyser_render');
  ctx = canvas.getContext('2d');
 
  // Re-route audio playback into the processing graph of the AudioContext
  source = context.createMediaElementSource(audio); 
  source.connect(analyser);
  analyser.connect(context.destination);
  frameLooper();
}


// frameLooper() animates any style of graphics you wish to the audio frequency
// Looping at the default frame rate that the browser provides(approx. 60 FPS)
function frameLooper(){
  window.requestAnimationFrame(frameLooper);
  fbc_array = new Uint8Array(analyser.frequencyBinCount);
  analyser.getByteFrequencyData(fbc_array);
  ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
 

//ctx.fillStyle = 'gradient';

  ctx.lineCap = 'round';
  bars = 840;
  for (var i = 0; i < bars; i++) {
    bar_x = i * 3;
    bar_width = 0.4;
    bar_height = -(fbc_array[i] / 2);

    
     
     
    //  fillRect( x, y, width, height ) // Explanation of the parameters below
    ctx.fillRect(bar_x, canvas.height, bar_width, bar_height);
    
    ctx.fillStyle = "#000000";
    ctx.fillS = grd;
  }
}

draw();



VisualizerSample.prototype.draw = function() {
  this.analyser.smoothingTimeConstant = SMOOTHING;
  this.analyser.fftSize = FFT_SIZE;

  // Get the frequency data from the currently playing music
  this.analyser.getByteFrequencyData(this.freqs);
  this.analyser.getByteTimeDomainData(this.times);

  var width = Math.floor(1/this.freqs.length, 10);

  var canvas = document.querySelector('canvas');
  var drawContext = canvas.getContext('2d');
  canvas.width = WIDTH;
  canvas.height = HEIGHT;
  // Draw the frequency domain chart.
  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {
    var value = this.freqs[i];
    var percent = value / 256;
    var height = HEIGHT * percent;
    var offset = HEIGHT - height - 1;
    var barWidth = WIDTH/this.analyser.frequencyBinCount;
    var hue = i/this.analyser.frequencyBinCount * 360;
    drawContext.fillStyle = 'hsl(' + hue + ', 100%, 50%)';
    drawContext.fillRect(i * barWidth, offset, barWidth, height);
  }

  // Draw the time domain chart.
  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {
    var value = this.times[i];
    var percent = value / 256;
    var height = HEIGHT * percent;
    var offset = HEIGHT - height - 1;
    var barWidth = WIDTH/this.analyser.frequencyBinCount;
    drawContext.fillStyle = 'white';
    drawContext.fillRect(i * barWidth, offset, 1, 2);
  }

  if (this.isPlaying) {
    requestAnimFrame(this.draw.bind(this));
  }
}

VisualizerSample.prototype.getFrequencyValue = function(freq) {
  var nyquist = context.sampleRate/2;
  var index = Math.round(freq/nyquist * this.freqs.length);
  return this.freqs[index];
}
</script>


































              
      <!--%# render "reviews/form" %>
      
       

        <%# if @song.reviews.blank? %>
          <h3>No reviews just yet, would you like to add the first!</h3>
          <%#= link_to "Write Review", new_song_review_path(@song), class: "btn btn-danger" %>
       
        <%# else %>
          <%# @reviews.each do |review| %>
            <div class="reviews">
              <div class="star-rating" data-score= <%#= review.rating %> ></div>
              <p><%#= review.comment %></p>
            </div>
          <%# end %>
        <%# end %-->









        


        <!--stars for stars-->

        <script>
    $('.star-rating').raty({
      path: '/assets/',
      readOnly: true,
      score: function() {
            return $(this).attr('data-score');
    }
  });
</script>

